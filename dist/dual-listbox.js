(()=>{var L="dual-listbox",p="dual-listbox__container",v="dual-listbox__available",E="dual-listbox__selected",m="dual-listbox__disabled",r="dual-listbox__title",c="dual-listbox__item",f="dual-listbox__buttons",x="dual-listbox__button",u="dual-listbox__search",T="dual-listbox__label",n="dual-listbox__item--selected",_="up",b="down",a=class{constructor(e,t={}){this.setDefaults(),this.selected=[],this.available=[],a.isDomElement(e)?this.select=e:this.select=document.querySelector(e),this._initOptions(t),this._initReusableElements(),this._splitOptions(this.select.options),t.options!==void 0&&this._splitOptions(t.options),this._buildDualListbox(this.select.parentNode),this._addActions(),this.sortable&&this._initializeSortButtons(),this.redraw()}setDefaults(){this.addEvent=null,this.removeEvent=null,this.availableTitle="Available options",this.selectedTitle="Selected options",this.showAddButton=!0,this.addButtonText="add",this.showRemoveButton=!0,this.removeButtonText="remove",this.showAddAllButton=!0,this.addAllButtonText="add all",this.showRemoveAllButton=!0,this.removeAllButtonText="remove all",this.searchPlaceholder="Search",this.selectedLabel=" Items Attached",this.sortable=!1,this.upButtonText="up",this.downButtonText="down"}addEventListener(e,t){this.dualListbox.addEventListener(e,t)}addSelected(e){let t=this.available.indexOf(e);t>-1&&(this.available.splice(t,1),this.selected.push(e),this._selectOption(e.dataset.id),this._updateSelectedlabel(this.selected.length),this.redraw(),setTimeout(()=>{let s=document.createEvent("HTMLEvents");s.initEvent("added",!1,!0),s.addedElement=e,this.dualListbox.dispatchEvent(s)},0))}redraw(){this.updateAvailableListbox(),this.updateSelectedListbox(),this.updateSelectedLabel()}removeSelected(e){let t=this.selected.indexOf(e);t>-1&&(this.selected.splice(t,1),this.available.push(e),this._deselectOption(e.dataset.id),this._updateSelectedlabel(this.selected.length),this.redraw(),setTimeout(()=>{let s=document.createEvent("HTMLEvents");s.initEvent("removed",!1,!0),s.removedElement=e,this.dualListbox.dispatchEvent(s)},0))}searchLists(e,t){let s=t.querySelectorAll(`.${c}`),i=e.toLowerCase();for(let l=0;l<s.length;l++){let d=s[l];d.textContent.toLowerCase().indexOf(i)===-1?d.style.display="none":d.style.display="list-item"}}updateAvailableListbox(){this._updateListbox(this.availableList,this.available)}updateSelectedListbox(){this._updateListbox(this.selectedList,this.selected)}updateSelectedLabel(){this._updateSelectedlabel(this.selected.length)}_actionAllSelected(e){e.preventDefault(),this.available.filter(s=>s.style.display!=="none").forEach(s=>this.addSelected(s))}_updateListbox(e,t){for(;e.firstChild;)e.removeChild(e.firstChild);for(let s=0;s<t.length;s++){let i=t[s];e.appendChild(i)}}_updateSelectedlabel(e){this.selected_label.innerText=e+this.selectedLabel}_actionItemSelected(e){e.preventDefault();let t=this.dualListbox.querySelector(`.${n}`);t&&this.addSelected(t)}_actionAllDeselected(e){e.preventDefault(),this.selected.filter(s=>s.style.display!=="none").forEach(s=>this.removeSelected(s))}_actionItemDeselected(e){e.preventDefault();let t=this.dualListbox.querySelector(`.${n}`);t&&this.removeSelected(t)}_actionItemDoubleClick(e,t=null){t&&(t.preventDefault(),t.stopPropagation()),this.selected.indexOf(e)>-1?this.removeSelected(e):this.addSelected(e)}_actionItemClick(e,t,s=null){s&&s.preventDefault();let i=t.querySelectorAll(`.${c}`);for(let l=0;l<i.length;l++){let d=i[l];d!==e&&d.classList.remove(n)}e.classList.contains(n)?e.classList.remove(n):e.classList.add(n)}_addActions(){this._addButtonActions(),this._addSearchActions()}_addButtonActions(){this.add_all_button.addEventListener("click",e=>this._actionAllSelected(e)),this.add_button.addEventListener("click",e=>this._actionItemSelected(e)),this.remove_button.addEventListener("click",e=>this._actionItemDeselected(e)),this.remove_all_button.addEventListener("click",e=>this._actionAllDeselected(e))}_addClickActions(e){return e.addEventListener("dblclick",t=>this._actionItemDoubleClick(e,t)),e.addEventListener("click",t=>this._actionItemClick(e,this.dualListbox,t)),e}_addSearchActions(){this.search_left.addEventListener("change",e=>this.searchLists(e.target.value,this.availableList)),this.search_left.addEventListener("keyup",e=>this.searchLists(e.target.value,this.availableList)),this.search_right.addEventListener("change",e=>this.searchLists(e.target.value,this.selectedList)),this.search_right.addEventListener("keyup",e=>this.searchLists(e.target.value,this.selectedList))}_buildDualListbox(e){this.select.style.display="none",this.dualListBoxContainer.appendChild(this._createList(this.search_left,this.availableListTitle,this.availableList)),this.dualListBoxContainer.appendChild(this.buttons);let t=this.selected_label;this.dualListBoxContainer.appendChild(this._createList(this.search_right,this.selectedListTitle,this.selectedList,this.selected_label)),this.dualListbox.appendChild(this.dualListBoxContainer),e.insertBefore(this.dualListbox,this.select)}_createList(e,t,s,i){let l=document.createElement("div");return l.appendChild(e),l.appendChild(t),l.appendChild(s),i&&l.appendChild(i),l}_createButtons(){this.buttons=document.createElement("div"),this.buttons.classList.add(f),this.add_all_button=document.createElement("button"),this.add_all_button.innerHTML=this.addAllButtonText,this.add_button=document.createElement("button"),this.add_button.innerHTML=this.addButtonText,this.remove_button=document.createElement("button"),this.remove_button.innerHTML=this.removeButtonText,this.remove_all_button=document.createElement("button"),this.remove_all_button.innerHTML=this.removeAllButtonText;let e={showAddAllButton:this.add_all_button,showAddButton:this.add_button,showRemoveButton:this.remove_button,showRemoveAllButton:this.remove_all_button};for(let t in e)if(t){let s=this[t],i=e[t];i.setAttribute("type","button"),i.classList.add(x),s&&this.buttons.appendChild(i)}}_createListItem(e){let t=document.createElement("li");return t.classList.add(c),t.innerHTML=e.text,t.dataset.id=e.value,e.disabled?t.classList.add(m):this._addClickActions(t),t}_createSearchLeft(){this.search_left=document.createElement("input"),this.search_left.classList.add(u),this.search_left.placeholder=this.searchPlaceholder}_createSearchRight(){this.search_right=document.createElement("input"),this.search_right.classList.add(u),this.search_right.placeholder=this.searchPlaceholder}_createSelectedLabel(){this.selected_label=document.createElement("label"),this.selected_label.classList.add(T),this.selected_label.innerText=this.selected.length+this.selectedLabel}_deselectOption(e){let t=this.select.options;for(let s=0;s<t.length;s++){let i=t[s];i.value===e&&(i.selected=!1,i.removeAttribute("selected"))}this.removeEvent&&this.removeEvent(e)}_initOptions(e){for(let t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}_initReusableElements(){this.dualListbox=document.createElement("div"),this.dualListbox.classList.add(L),this.select.id&&this.dualListbox.classList.add(this.select.id),this.dualListBoxContainer=document.createElement("div"),this.dualListBoxContainer.classList.add(p),this.availableList=document.createElement("ul"),this.availableList.classList.add(v),this.selectedList=document.createElement("ul"),this.selectedList.classList.add(E),this.availableListTitle=document.createElement("div"),this.availableListTitle.classList.add(r),this.availableListTitle.innerText=this.availableTitle,this.selectedListTitle=document.createElement("div"),this.selectedListTitle.classList.add(r),this.selectedListTitle.innerText=this.selectedTitle,this._createButtons(),this._createSearchLeft(),this._createSearchRight(),this._createSelectedLabel()}_selectOption(e){let t=this.select.options;for(let s=0;s<t.length;s++){let i=t[s];i.value===e&&(i.selected=!0,i.setAttribute("selected",""))}this.addEvent&&this.addEvent(e)}_splitOptions(e){for(let t=0;t<e.length;t++){let s=e[t];a.isDomElement(s)?this._addOption({text:s.innerHTML,value:s.value,selected:s.attributes.selected,disabled:s.attributes.disabled}):this._addOption(s)}}_addOption(e){let t=this._createListItem(e);e.selected?this.selected.push(t):this.available.push(t)}_initializeSortButtons(){let e=document.createElement("button");e.classList.add("dual-listbox__button"),e.innerText=this.upButtonText,e.addEventListener("click",i=>this._onSortButtonClick(i,_));let t=document.createElement("button");t.classList.add("dual-listbox__button"),t.innerText=this.downButtonText,t.addEventListener("click",i=>this._onSortButtonClick(i,b));let s=document.createElement("div");s.classList.add("dual-listbox__buttons"),s.appendChild(e),s.appendChild(t),this.dualListBoxContainer.appendChild(s)}_onSortButtonClick(e,t){e.preventDefault();let[s,i]=this._findSelected(t);s!==i&&(this._sortUnderlyingSelectOptions(s,i),this._sortSelected(s,i),this.redraw())}_findSelected(e){let t=this.selected.findIndex(i=>i.classList.contains("dual-listbox__item--selected")),s=t;return _===e&&t>0?s-=1:b===e&&t<this.selected.length-1&&(s+=1),[t,s]}_sortUnderlyingSelectOptions(e,t){let s=this.selected[e].getAttribute("data-id"),i=this.selected[t].getAttribute("data-id"),l=[...this.select.children].findIndex(o=>o.value===s),d=[...this.select.children].findIndex(o=>o.value===i),h=this.select.children[l];h.remove(),this.select.insertBefore(h,this.select.children[d])}_sortSelected(e,t){let s=this.selected[e];this.selected.splice(e,1),this.selected.splice(t,0,s)}static isDomElement(e){return typeof HTMLElement=="object"?e instanceof HTMLElement:e&&typeof e=="object"&&e!==null&&e.nodeType===1&&typeof e.nodeName=="string"}};window.DualListbox=a;var S=a;})();
//# sourceMappingURL=dual-listbox.js.map
